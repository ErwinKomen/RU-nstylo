{% extends "layout.html" %}
{% load i18n %}

{% block breadcrumbs %}
  <div class="breadcrumbs">
      <a href="{% url 'home' %}">Home</a>
      &rsaquo; Frequency Tables
  </div>
{% endblock %}

{% block content %}
  <div class="container body-content">

    {% if authenticated %}
      <!-- Room for errors -->
      <div id="research_err"></div>

      <!-- Provide details of this set -->
      <div class="row">
        <h3>Titles and authors (sorted)</h3>
        <table>
          <thead><tr><th>#</th><th>Author</th><th>Title</th></tr></thead>
          <tbody>
            {% for item in headers %}
            <tr>
              <td>{{forloop.counter}}</td>
              <td>{{item.author}}</td>
              <td>{{item.title}}</td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>

      <!-- Continue if there is a status -->
      {% if status %}
        <div class="row">Status: {{status}}</div>

        <!-- Process a response -->
        {% if r_response %}
          <div class="row">R response: {{r_response}}</div>
        {% endif %}

        <!-- Show the contents -->
        {% if r_contents %}
          <div class="row">
            <h4>PCA coordinates:</h4>
            <table>
              <thead>
                <tr>
                  {% for colheading in r_contents.colnames %}
                  <th>{{colheading}}</th>
                  {% endfor %}
                </tr>
              </thead>
              <tbody>
                {% for row in r_contents.fulltable %}
                {% if not forloop.first %}
                <tr>
                  {% for cell in row %}
                    <td>{{cell}}</td>
                  {% endfor %}
                </tr>
                {% endif %}
                {% endfor %}
              </tbody>
            </table>
          </div>
        {% endif %}

        <!-- Make room for an SVG plot-->
        <div id="svgplot">
          <!-- This is where the SVG will appear -->
        </div>
      {% endif %}

    <!-- The script to run the code -->
    <script>
      // Call the function to get the data and draw a chart
      ru.nstylo.showtabledata("{% url 'tabledata' pk=table_id %}", "#svgplot");
    </script>


    {% else %}
      <div class="explanation">
        <p>Dear user, you are <b>not</b> logged in.</p>
        <p>Unfortunately this means that you will not be able to see any of the functions that are available.</p>
        <p>Should you want to work with Cesar, then here are your options:
          <ul>
            <li><a class="btn btn-info btn-xs" href="{% url 'login' %}">Login</a> - if you have an account</li> 
          </ul>
        </p>
      </div>
    {% endif %}

  </div>


{% endblock %}